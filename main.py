##### WORKS CITED ************

# Pygame Framework form 15-112 TA Lukas (http://blog.lukasperaza.com/getting-started-with-pygame)
# 2016 MLB statistics taken from MLB.com
# MLB rosters and lineups taken from Bleacher Report (http://bleacherreport.com/articles/2696277-updated-spring-training-predictions-for-all-30-mlb-teams-final-25-man-rosters and http://bleacherreport.com/articles/2688221-projecting-every-mlb-teams-starting-lineup-2-weeks-from-spring-training)
#MLB logos retrieved from http://www.sportslogos.net/teams/list_by_league/4/Major_League_Baseball/MLB/logos/
####OTHER IMAGES
#https://www.google.com/url?sa=i&rct=j&q=&esrc=s&source=images&cd=&cad=rja&uact=8&ved=0ahUKEwjKgLOuidfTAhVD02MKHaOJCRYQjRwIBw&url=http%3A%2F%2Fwww.adambielecki.com%2F2015%2F10%2Fcool-loading-screen-for-unity-3d.html&psig=AFQjCNHbmzVAGi2t8gBy6LQbhon0cbzFYw&ust=1494015976730109
#https://i.ytimg.com/vi/dvN1iSxZIC8/maxresdefault.jpg
#http://wallpapercave.com/wp/MGKsbvO.jpg
#http://1.bp.blogspot.com/-syyDU_HEHPA/UTx_j1PBCXI/AAAAAAAAD5Y/dHFjA5YR9cE/s1600/baseball+fielder+clip+2.jpg
#data:image/jpeg;base64,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


import pygame
import random
import os
import math
from gameEngine import *
from team import *

# colors

WHITE = (255, 255, 255)
BLACK = (0,0,0)
RED = (255,20,20)
DULL_GREEN= (32,173,0)
BRIGHT_GREEN=(43,235,0)
LIGHT_GRAY=(168,168,168)
GRAY=(100,100,100)
DARK_BLUE=(0,32,66)
DARKER_BLUE=(2,0,36)
LIGHT_YELLOW=(254,255,189)
SOLID_YELLOW=(255,239,15)

GRAVITY=.5
DRAG=.1

class PygameGame(object):

    def isKeyPressed(self, key):
        ''' return whether a specific key is being held '''
        return self._keys.get(key, False)
#menuImage is (660,427)
    def __init__(self, width=1000, height=650, fps=30, title="112 Pygame Game"):
        self.width = width
        self.height = height
        self.fps = fps
        self.title = title
        pygame.init()

    def init(self,screen):
        self.loadingImage=pygame.image.load('assets\\images\\Loading.jpg')
        scaledLoadingImage=pygame.transform.scale(self.loadingImage, (self.width,self.height))
        screen.blit(scaledLoadingImage,(0,0))
        pygame.display.flip()
        self.playerInfo=initPlayerLoad('assets\\playerData\\Player Ratings.txt')
        self.mlbPlayers=dict()
        #print(self.playerInfo)
        self.loadMLBPlayers()
        #getBattingStats(self.mlbPlayers)
        self.loadMLBTeams()
        self.mode='Menu'
        self.callersMode=self.mode
        self.highlightedTeam=0
        self.lineupScreen=False
        self.lineupPlayerSelected=None
        self.selectedCell1=None
        self.selectedCell2=None
        self.selectedCell3=None
        self.selectedCell4=None
        self.selectedCell5=None
        self.selectedCell6=None
        self.selectingPitcher=False
        self.selectingBatter=False
        self.selectedTeams=[self.ARZ,self.ARZ]
        self.teamIndexes=[0,0]
        self.allTeams=[self.ARZ,self.ATL,self.BAL,self.BOS,self.CHC, self.CHW, self.CIN,self.CLE,self.COL,self.DET,self.HOU,self.KC,self.LAA,self.LAD,self.MIA,self.MIL,self.MIN,self.NYM,self.NYY,self.OAK,self.PHI,self.PIT,self.STL,self.SDP,self.SFG,self.SEA,self.TB,self.TEX,self.TOR,self.WSH]

        #SURFACES
        self.aboutSurface=pygame.Surface((self.width*.7,self.height*.65))
        self.playNowHighlight=pygame.Surface((self.width*.3,self.height*.65))
        self.lineupBackgroundSurface=pygame.Surface((self.width*.85,self.height*.9))

        #IMAGES
        self.menuImage=pygame.image.load("assets\\images\\Menu.jpg")
        self.backgroundImage=pygame.image.load("assets\\images\\Background.jpg")
        self.MLB=pygame.image.load('assets\\images\\MLB.png')
        self.fieldImage=pygame.image.load('assets\\images\\Field.jpg')
        self.lineupImage=pygame.image.load('assets\\images\\Lineup.jpg')
        self.fieldImageWidth=int(.67*self.width)
        self.fielderImage=pygame.image.load('assets\\images\\Fielder.png')
        self.pitcherImage=pygame.image.load('assets\\images\\Pitcher.png')
        self.catcherImage=pygame.image.load('assets\\images\\Catcher.png')
        self.batterImage=pygame.image.load('assets\\images\\Batter.png')
        self.runnerImage=pygame.image.load('assets\\images\\Baserunner.png')
        self.ballImage=pygame.image.load('assets\\images\\Baseball.png')
        self.ballShadowImage=pygame.image.load('assets\\images\\Shadow.png')
        self.scaledBallImage=pygame.transform.scale(self.ballImage, (5,5))
        self.scaledShadowImage=pygame.transform.scale(self.ballShadowImage, (7,5))

        #COLORS
        self.titleRectColor=RED
        self.titleBorderRectColor=DARK_BLUE
        self.playNowRectColor=DULL_GREEN
        self.aboutRectColor=DULL_GREEN
        self.exitRectColor=DULL_GREEN
        self.aboutTextRectColor=LIGHT_GRAY
        self.aboutBackRectColor=DULL_GREEN
        self.playNowBackRectColor=DULL_GREEN
        self.playNowPlayRectColor=DULL_GREEN
        self.gameOverMenuRectColor=DULL_GREEN
        self.gameOverBoxScoreRectColor=DULL_GREEN
        self.playNowHighlightColor=LIGHT_YELLOW
        self.lineupBackgroundSurfaceColor=LIGHT_GRAY
        self.lineupPlayRectColor=DULL_GREEN
        self.sideBarColor=DARKER_BLUE
        self.fBaseColor=LIGHT_GRAY
        self.sBaseColor=LIGHT_GRAY
        self.tBaseColor=LIGHT_GRAY
        self.out1Color=LIGHT_GRAY
        self.out2Color=LIGHT_GRAY
        self.boxScoreBackRectColor=DULL_GREEN
        self.boxScoreMenuRectColor=DULL_GREEN
        self.lineupBackRectColor=DULL_GREEN

        #FONTS
        self.titleFont=pygame.font.SysFont('Arial',int(self.height*.1))
        self.buttonFont=pygame.font.SysFont('Arial',int(self.height*.045))
        self.normalTextFont=pygame.font.SysFont('Arial',int(self.height*.045))
        self.pageTitleFont=pygame.font.SysFont('Arial', int(self.height*.07))
        self.playNowTeamFont=pygame.font.SysFont('Arial',int(self.height*.07))
        self.playNowTeamFont.set_italic(True)
        self.smallTextFont=pygame.font.SysFont('Arial',int(self.height*.018))
        self.slightSmallTextFont=pygame.font.SysFont('Arial',int(self.height*.03))
        self.hugeTextFont=pygame.font.SysFont('Arial',int(self.height*.15))
        self.hugeTextFont.set_bold(True)

        #RECTS
        self.titleRect=pygame.Rect(self.width*.1,self.height*.04,self.width*.8,self.height*.12)
        self.titleBorderRect=pygame.Rect(self.width*.08,self.height*.02,self.width*.84,self.height*.16)
        self.playNowRect=pygame.Rect(self.width*.425,self.height*.3,self.width*.15,self.height*.07)
        self.aboutRect=pygame.Rect(self.width*.425,self.height*.4,self.width*.15,self.height*.07)
        self.exitRect=pygame.Rect(self.width*.425,self.height*.5,self.width*.15,self.height*.07)
        self.aboutBackRect=pygame.Rect(self.width*.7,self.height*.88,self.width*.15,self.height*.07)
        self.playNowBackRect=pygame.Rect(self.width*.15,self.height*.88,self.width*.15,self.height*.07)
        self.playNowPlayRect=pygame.Rect(self.width*.7,self.height*.88,self.width*.15,self.height*.07)
        self.lineupPlayRect=pygame.Rect(self.width*.1,self.height*0,self.width*.8,self.height*.1)
        self.sideBarRect=pygame.Rect(self.fieldImageWidth,0,self.width-self.fieldImageWidth,self.height)
        self.sideBarAwayRect=pygame.Rect(self.fieldImageWidth,self.height*.475,self.width-self.fieldImageWidth,self.height*.05)
        self.sideBarHomeRect=pygame.Rect(self.fieldImageWidth,self.height*.725,self.width-self.fieldImageWidth,self.height*.05)
        self.fieldDisplayRect=pygame.Rect(0,0,self.fieldImageWidth,self.height*.15)
        self.currBatterRect=pygame.Rect(0,self.height*.9,self.fieldImageWidth*.4,self.height*.2)
        self.currPitcherRect=pygame.Rect(self.fieldImageWidth*.6,self.height*.9,self.fieldImageWidth*.4,self.height*.2)
        self.gameOverMenuRect=pygame.Rect(self.width*.05,self.height*.9,self.width*.15,self.height*.07)
        self.gameOverBoxScoreRect=pygame.Rect(self.width*.8,self.height*.9,self.width*.15,self.height*.07)
        self.boxScoreMenuRect=pygame.Rect(self.width*.05,self.height*.9,self.width*.15,self.height*.07)
        self.boxScoreBackRect=pygame.Rect(self.width*.8,self.height*.9,self.width*.15,self.height*.07)
        self.lineupBackRect=pygame.Rect(self.width*.425,self.height*.93,self.width*.15,self.height*.07)

        #ANIMATION VARS
        self.CStart=(337,597)
        self.fBStart=(458,435)
        self.sBStart=(380,388)
        self.SSStart=(280,398)
        self.tBStart=(209,443)
        self.LFStart=(150,316)
        self.CFStart=(339,300)
        self.RFStart=(530,315)
        self.PStart=(336,463)
        self.ABStart=(330,575)
        self.ballInPlay=False
        self.ballBeingPitched=False
        self.delay=0
        self.displayDelay=False
        self.displayDelayTime=50
        self.delayF=0
        self.autoplay=False
        self.sim=False
        self.actionOnly=False
        self.playTimer=100
        self.fence=Fence()

    def run(self):

        clock = pygame.time.Clock()
        screen = pygame.display.set_mode((self.width, self.height))
        # set the title of the window
        pygame.display.set_caption(self.title)

        # stores all the keys currently being held down
        self._keys = dict()

        # call game-specific initialization
        self.init(screen)
        self.playing = True
        while self.playing:
            time = clock.tick(self.fps)
            self.timerFired(time)
            for event in pygame.event.get():
                if event.type == pygame.MOUSEBUTTONDOWN and event.button == 1:
                    self.mousePressed(*(event.pos))
                elif event.type == pygame.MOUSEBUTTONUP and event.button == 1:
                    self.mouseReleased(*(event.pos))
                elif (event.type == pygame.MOUSEMOTION and
                      event.buttons == (0, 0, 0)):
                    self.mouseMotion(*(event.pos))
                elif (event.type == pygame.MOUSEMOTION and
                      event.buttons[0] == 1):
                    self.mouseDrag(*(event.pos))
                elif event.type == pygame.KEYDOWN:
                    self._keys[event.key] = True
                    self.keyPressed(event.key, event.mod)
                elif event.type == pygame.KEYUP:
                    self._keys[event.key] = False
                    self.keyReleased(event.key, event.mod)
                elif event.type == pygame.QUIT:
                    self.playing = False
            screen.fill((255, 255, 255))
            self.redrawAll(screen)
            pygame.display.flip()

        pygame.quit()

# Mode dispatcher
    def mousePressed(self, x, y):
        if(self.mode == 'Menu'): self.menuMousePressed(x, y)
        elif(self.mode == 'About'): self.aboutMousePressed(x, y)
        elif(self.mode == 'Play Now'): self.playNowMousePressed(x, y)
        elif(self.mode == 'In-game'): self.inGameMousePressed(x, y)
        elif(self.mode == 'Roster'): self.rosterMousePressed(x, y)
        elif(self.mode == 'Box Score'): self.boxScoreMousePressed(x,y)

    def mouseReleased(self, x, y):
        if(self.mode == 'Menu'): self.menuMouseReleased(x, y)
        elif(self.mode == 'About'): self.aboutMouseReleased(x, y)
        elif(self.mode == 'Play Now'): self.playNowMouseReleased(x, y)
        elif(self.mode == 'In-game'): self.inGameMouseReleased(x, y)
        elif(self.mode == 'Roster'): self.rosterMouseReleased(x, y)

    def mouseMotion(self, x, y):
        if(self.mode == 'Menu'): self.menuMouseMotion(x, y)
        elif(self.mode == 'About'): self.aboutMouseMotion(x, y)
        elif(self.mode == 'Play Now'): self.playNowMouseMotion(x, y)
        elif(self.mode == 'In-game'): self.inGameMouseMotion(x, y)
        elif(self.mode == 'Roster'): self.rosterMouseMotion(x, y)

    def mouseDrag(self, x, y):
        if(self.mode == 'Menu'): self.menuMouseDrag(x, y)
        elif(self.mode == 'About'): self.aboutMouseDrag(x, y)
        elif(self.mode == 'Play Now'): self.playNowMouseDrag(x, y)
        elif(self.mode == 'In-game'): self.inGameMouseDrag(x, y)
        elif(self.mode == 'Roster'): self.rosterMouseDrag(x, y)

    def keyPressed(self, keyCode, modifier):
        if(self.mode == 'Menu'): self.menuKeyPressed(keyCode, modifier)
        elif(self.mode == 'About'): self.aboutKeyPressed(keyCode, modifier)
        elif(self.mode == 'Play Now'): self.playNowKeyPressed(keyCode, modifier)
        elif(self.mode == 'In-game'): self.inGameKeyPressed(keyCode, modifier)
        elif(self.mode == 'Roster'): self.rosterKeyPressed(keyCode, modifier)

    def keyReleased(self, keyCode, modifier):
        if keyCode==109:
            self.mPressed()
        elif keyCode==104 and self.mode!='About':
            self.callersMode=self.mode
            self.mode='About'
        elif keyCode==104 and self.mode=='About':
            self.mode=self.callersMode
            self.callersMode=self.mode
        if(self.mode == 'Menu'): self.menuKeyReleased(keyCode, modifier)
        elif(self.mode == 'About'): self.aboutKeyReleased(keyCode, modifier)
        elif(self.mode == 'Play Now'): self.playNowKeyReleased(keyCode, modifier)
        elif(self.mode == 'In-game'): self.inGameKeyReleased(keyCode, modifier)
        elif(self.mode == 'Roster'): self.rosterKeyReleased(keyCode, modifier)

    def timerFired(self, dt):
        if(self.mode == 'Menu'): self.menuTimerFired(dt)
        elif(self.mode == 'About'): self.aboutTimerFired(dt)
        elif(self.mode == 'Play Now'): self.playNowTimerFired(dt)
        elif(self.mode == 'In-game'): self.inGameTimerFired(dt)
        elif(self.mode == 'Roster'): self.rosterTimerFired(dt)

    def redrawAll(self, screen):
        if(self.mode == 'Menu'): self.menuRedrawAll(screen)
        elif(self.mode == 'About'): self.aboutRedrawAll(screen)
        elif(self.mode == 'Play Now'): self.playNowRedrawAll(screen)
        elif(self.mode == 'In-game'): self.inGameRedrawAll(screen)
        elif(self.mode == 'Roster'): self.rosterRedrawAll(screen)
        elif(self.mode == 'Box Score'): self.boxScoreRedrawAll(screen)

    def isKeyPressed(self, key):
        if(self.mode == 'Menu'): self.menuIsKeyPressed(key)
        elif(self.mode == 'About'): self.aboutIsKeyPressed(key)
        elif(self.mode == 'Play Now'): self.playNowIsKeyPressed(key)
        elif(self.mode == 'In-game'): self.inGameIsKeyPressed(key)
        elif(self.mode == 'Roster'): self.rosterIsKeyPressed(key)

#MENU

    def menuMousePressed(self, x, y):
        if self.playNowRect.collidepoint(x,y):
            self.playNowModeSelector=False
            self.playNowSelectedMode=None
            self.playNowUserTeam=None
            self.playNowModeSelectorHighlightedTeam=0
            self.mode='Play Now'
        elif self.aboutRect.collidepoint(x,y):
            self.callersMode=self.mode
            self.mode='About'
        elif self.exitRect.collidepoint(x,y):
            self.playing=False

    def menuMouseReleased(self, x, y):
        pass

    def menuMouseMotion(self, x, y):
        pass

    def menuMouseDrag(self, x, y):
        pass

    def menuKeyPressed(self, keyCode, modifier):
        #print(keyCode)
        pass

    def menuKeyReleased(self, keyCode, modifier):
        pass

    def menuTimerFired(self, dt):
        pass

    def menuRedrawAll(self, screen):
        #Button Highlight
        if self.playNowRect.collidepoint(pygame.mouse.get_pos()):
            self.playNowRectColor=BRIGHT_GREEN
        else:
            self.playNowRectColor=DULL_GREEN
        if self.aboutRect.collidepoint(pygame.mouse.get_pos()):
            self.aboutRectColor=BRIGHT_GREEN
        else:
            self.aboutRectColor=DULL_GREEN
        if self.exitRect.collidepoint(pygame.mouse.get_pos()):
            self.exitRectColor=BRIGHT_GREEN
        else:
            self.exitRectColor=DULL_GREEN
        #Background
        scaledMenuImage=pygame.transform.scale(self.menuImage, (self.width,self.height))
        screen.blit(scaledMenuImage,(0,0))
        #Title
        pygame.draw.rect(screen,self.titleBorderRectColor,self.titleBorderRect)
        pygame.draw.rect(screen,self.titleRectColor,self.titleRect)
        self.displayText(screen,self.title,self.titleFont,WHITE,center=self.titleRect.center)
        #Play Now
        pygame.draw.rect(screen,self.playNowRectColor,self.playNowRect)
        self.displayText(screen,'PLAY NOW!',self.buttonFont,WHITE,center=self.playNowRect.center)
        #About
        pygame.draw.rect(screen,self.aboutRectColor,self.aboutRect)
        self.displayText(screen,'ABOUT',self.buttonFont,WHITE,center=self.aboutRect.center)
        #Exit
        pygame.draw.rect(screen,self.exitRectColor,self.exitRect)
        self.displayText(screen,'EXIT',self.buttonFont,WHITE,center=self.exitRect.center)

    def menuIsKeyPressed(self, key):
        return self._keys.get(key, False)

#ABOUT
    def aboutMousePressed(self, x, y):
        if self.aboutBackRect.collidepoint(x,y):
            self.mode=self.callersMode

    def aboutMouseReleased(self, x, y):
        pass

    def aboutMouseMotion(self, x, y):
        pass

    def aboutMouseDrag(self, x, y):
        pass

    def aboutKeyPressed(self, keyCode, modifier):
        pass

    def aboutKeyReleased(self, keyCode, modifier):
        pass

    def aboutTimerFired(self, dt):
        pass

    def aboutRedrawAll(self, screen):
        #Background
        scaledBackgroundImage=pygame.transform.scale(self.backgroundImage, (self.width,self.height))
        screen.blit(scaledBackgroundImage,(0,0))
        #title box
        pygame.draw.rect(screen,self.titleBorderRectColor,self.titleBorderRect)
        pygame.draw.rect(screen,self.titleRectColor,self.titleRect)
        self.displayText(screen,self.title,self.titleFont,WHITE,center=self.titleRect.center)
        #text box
        self.aboutSurface.set_alpha(210)
        self.aboutSurface.fill(self.aboutTextRectColor)
        screen.blit(self.aboutSurface,(self.width*.15,self.height*.20))
        #back button
        if self.aboutBackRect.collidepoint(pygame.mouse.get_pos()):
            self.aboutBackRectColor=BRIGHT_GREEN
        else:
            self.aboutBackRectColor=DULL_GREEN
        pygame.draw.rect(screen, self.aboutBackRectColor, self.aboutBackRect)
        self.displayText(screen, 'BACK',self.buttonFont,WHITE,center=self.aboutBackRect.center)
        #About page
        self.displayText(screen, 'ABOUT',self.pageTitleFont,BLACK,pos=(self.width*.17,self.height*.20))
        if self.callersMode=='Menu':
            self.displayText(screen,'MLB Simulator 2017 is baseball simulation game where the game comes to life. Watch as your',self.slightSmallTextFont,BLACK,pos=(self.width*.16,self.height*.33))
            self.displayText(screen,'favorite real-life teams compete with customizable lineups and pitching rotations.',self.slightSmallTextFont,BLACK,pos=(self.width*.16,self.height*.38))
            self.displayText(screen,'Gameplay reflects player skill as real MLB stats were used to realistically model players.',self.slightSmallTextFont,BLACK,pos=(self.width*.16,self.height*.43))
            self.displayText(screen,'Press the \'h\' key anytime for help in different pages. Press \'h\' or \'BACK\' to return to previous page.',self.slightSmallTextFont,BLACK,pos=(self.width*.16,self.height*.48))
        elif self.callersMode=='Play Now':
            self.displayText(screen,'Use the \'a\'/\'d\' keys to highlight a team and \'w\'/\'s\' keys to select a team.',self.slightSmallTextFont,BLACK,pos=(self.width*.16,self.height*.33))
            self.displayText(screen,'Alternatively, you can radndomize your team selection using the \'r\' key.',self.slightSmallTextFont,BLACK,pos=(self.width*.16,self.height*.38))
            self.displayText(screen,'Press \'PLAY\' to go to lineup screen or \'MENU\' to go back to the menu.',self.slightSmallTextFont,BLACK,pos=(self.width*.16,self.height*.43))
        elif self.callersMode=='In-game':
            self.displayText(screen,'You can alter the lineup order by selecting a player and then selecting a second player',self.slightSmallTextFont,BLACK,pos=(self.width*.16,self.height*.33))
            self.displayText(screen,'to swap lineup positions with. While a player is selected, you can also use the \'c\' key to',self.slightSmallTextFont,BLACK,pos=(self.width*.16,self.height*.38))
            self.displayText(screen,'exchange that player\'s position with another player. You can also select your starting',self.slightSmallTextFont,BLACK,pos=(self.width*.16,self.height*.43))
            self.displayText(screen,'pitcher using the \'c\' while having the pitcher selected at the bottom.',self.slightSmallTextFont,BLACK,pos=(self.width*.16,self.height*.48))
            self.displayText(screen,'In the game, press \'SPACE\' to play next pitch. You can also press \'a\' to turn on autoplay.',self.slightSmallTextFont,BLACK,pos=(self.width*.16,self.height*.53))
            self.displayText(screen,'Pressing \'d\' will turn on Direct Action Mode, where only pitches that result in change of',self.slightSmallTextFont,BLACK,pos=(self.width*.16,self.height*.58))
            self.displayText(screen,'game state are shown. Finally, you can use \'>\' to speed up gameplay or \'<\' to slow it down.',self.slightSmallTextFont,BLACK,pos=(self.width*.16,self.height*.63))
        else:
            self.displayText(screen,'That\'s all! Hope you enjoyed! I have nothing else to say.',self.slightSmallTextFont,BLACK,pos=(self.width*.16,self.height*.33))
            self.displayText(screen,'There is nothing important I can put on this page, why are you still reading this?',self.slightSmallTextFont,BLACK,pos=(self.width*.16,self.height*.38))
            self.displayText(screen,'I\'m literally telling you that you are wasting time yet you continue on anyway.',self.slightSmallTextFont,BLACK,pos=(self.width*.16,self.height*.43))
            self.displayText(screen,'I wonder if I just keep printing text, will you continue reading?',self.slightSmallTextFont,BLACK,pos=(self.width*.16,self.height*.48))
            self.displayText(screen,'Probably you will continue. This was fun. Please give me A lol.',self.slightSmallTextFont,BLACK,pos=(self.width*.16,self.height*.53))


    def aboutIsKeyPressed(self, key):
        return self._keys.get(key, False)

#PLAY NOW
    def playNowMousePressed(self, x, y):
        if self.playNowBackRect.collidepoint(x,y):
            self.mode='Menu'
        elif self.playNowPlayRect.collidepoint(x,y):
            self.mode='In-game'
            self.game=Game(self.selectedTeams)
            self.lineupScreen=True
            self.createFielders()
            self.createBatter()
            self.awayIndex=0
            self.homeIndex=0
            self.gameOver=False
            self.outs=0
            self.inning=1
            self.topInning=True
            self.battingTeam=self.game.awayTeam
            self.pitchingTeam=self.game.homeTeam
            self.battingTeamIndex=0
            self.pitchingTeamIndex=1
            self.score=[0,0]
            self.inningScore=[[0,0]]
            self.hits=[0,0]
            self.errors=[0,0]
            self.count=[0,0]
            self.bases=[None,None,None]
            self.i=0

    def playNowMouseReleased(self, x, y):
        pass

    def playNowMouseMotion(self, x, y):
        pass

    def playNowMouseDrag(self, x, y):
        pass

    def playNowKeyPressed(self, keyCode, modifier):
        if keyCode==276 or keyCode==97:
            self.highlightedTeam=0
        elif keyCode==275 or keyCode==100:
            self.highlightedTeam=1
        elif keyCode==273 or keyCode==119:
            self.teamIndexes[self.highlightedTeam]-=1
            self.selectedTeams[self.highlightedTeam]=self.allTeams[self.teamIndexes[self.highlightedTeam]%len(self.allTeams)]
        elif keyCode==274 or keyCode==115:
            self.teamIndexes[self.highlightedTeam]+=1
            self.selectedTeams[self.highlightedTeam]=self.allTeams[self.teamIndexes[self.highlightedTeam]%len(self.allTeams)]
        elif keyCode==114:
            self.selectedTeams[self.highlightedTeam]=random.choice(self.allTeams)
            self.teamIndexes[self.highlightedTeam]=self.allTeams.index(self.selectedTeams[self.highlightedTeam])

    def playNowKeyReleased(self, keyCode, modifier):
        pass

    def playNowTimerFired(self, dt):
        pass

    def playNowRedrawAll(self, screen):
        #Background
        scaledBackgroundImage=pygame.transform.scale(self.backgroundImage, (self.width,self.height))
        screen.blit(scaledBackgroundImage,(0,0))
        #title box
        pygame.draw.rect(screen,self.titleBorderRectColor,self.titleBorderRect)
        pygame.draw.rect(screen,self.titleRectColor,self.titleRect)
        self.displayText(screen,self.title,self.titleFont,WHITE,center=self.titleRect.center)
        #back button
        if self.playNowBackRect.collidepoint(pygame.mouse.get_pos()):
            self.playNowBackRectColor=BRIGHT_GREEN
        else:
            self.playNowBackRectColor=DULL_GREEN
        pygame.draw.rect(screen, self.playNowBackRectColor, self.playNowBackRect)
        self.displayText(screen, 'BACK',self.buttonFont,WHITE,center=self.playNowBackRect.center)
        #play button
        if self.playNowPlayRect.collidepoint(pygame.mouse.get_pos()):
            self.playNowPlayRectColor=BRIGHT_GREEN
        else:
            self.playNowPlayRectColor=DULL_GREEN
        pygame.draw.rect(screen, self.playNowPlayRectColor, self.playNowPlayRect)
        self.displayText(screen, 'PLAY',self.buttonFont,WHITE,center=self.playNowPlayRect.center)
        #select teams
        self.playNowHighlight.set_alpha(200)
        self.playNowHighlight.fill(self.playNowHighlightColor)
        if self.highlightedTeam==0:
            screen.blit(self.playNowHighlight,(self.width*.15,self.height*.2))
            pygame.draw.polygon(screen,WHITE,[(self.width*.47,self.height*.5),(self.width*.53,self.height*.4),(self.width*.53,self.height*.6)])
        else:
            screen.blit(self.playNowHighlight,(self.width*.55,self.height*.2))
            pygame.draw.polygon(screen,WHITE,[(self.width*.53,self.height*.5),(self.width*.47,self.height*.4),(self.width*.47,self.height*.6)])
        if self.selectedTeams[0]=='ATL':
            logoScaler1=.17
        else:
            logoScaler1=.25
        if self.selectedTeams[1]=='ATL':
            logoScaler2=.17
        else:
            logoScaler2=.25
        scaledTeam1Logo=pygame.transform.scale(self.selectedTeams[0].logo,(int(self.height*logoScaler1*self.selectedTeams[0].logoRatio),int(self.height*logoScaler1)))
        scaledTeam2Logo=pygame.transform.scale(self.selectedTeams[1].logo,(int(self.height*logoScaler2*self.selectedTeams[1].logoRatio),int(self.height*logoScaler2)))
        screen.blit(scaledTeam1Logo,(self.width*.3-scaledTeam1Logo.get_width()/2,self.height*.525-scaledTeam1Logo.get_height()/2))
        screen.blit(scaledTeam2Logo,(self.width*.7-scaledTeam2Logo.get_width()/2,self.height*.525-scaledTeam2Logo.get_height()/2))
        self.displayText(screen,self.selectedTeams[0].cityName,self.playNowTeamFont,BLACK,center=(self.width*.3,self.height*.73))
        self.displayText(screen,self.selectedTeams[0].name,self.playNowTeamFont,BLACK,center=(self.width*.3,self.height*.8))
        self.displayText(screen,self.selectedTeams[1].cityName,self.playNowTeamFont,BLACK,center=(self.width*.7,self.height*.73))
        self.displayText(screen,self.selectedTeams[1].name,self.playNowTeamFont,BLACK,center=(self.width*.7,self.height*.8))
        if self.highlightedTeam==0:
            self.displayText(screen,'AWAY',self.pageTitleFont,BLACK,pos=(self.width*.18,self.height*.22))
        else:
            self.displayText(screen,'AWAY',self.pageTitleFont,WHITE,pos=(self.width*.18,self.height*.22))
        if self.highlightedTeam==1:
            self.displayText(screen,'HOME',self.pageTitleFont,BLACK,pos=(self.width*.58,self.height*.22))
        else:
            self.displayText(screen,'HOME',self.pageTitleFont,WHITE,pos=(self.width*.58,self.height*.22))
        
    def playNowIsKeyPressed(self, key):
        return self._keys.get(key, False)






#IN-GAME

    def inGameMousePressed(self, x, y):
        if self.lineupScreen:
            if not (self.selectingPitcher or self.selectingBatter):
                if self.lineupPlayRect.collidepoint(x,y):
                    self.lineupScreen=False
                if self.lineupBackRect.collidepoint(x,y):
                    self.mode='Play Now'
                if self.width*.125<=x<=self.width*.475 and self.height*.2<=y<=self.height*.74:
                    cellHeight=self.height*.54/9
                    newSelectedCell1=int((y-self.height*.2)/cellHeight)
                    if self.selectedCell1==None:
                        self.selectedCell1=newSelectedCell1
                        self.selectedCell2=None
                        self.selectedCell3=None
                        self.selectedCell4=None
                    elif newSelectedCell1==self.selectedCell1:
                        self.selectedCell1=None
                    else:
                        self.playerSwap(newSelectedCell1,self.selectedCell1,self.game.awayTeam.lineup)
                        self.selectedCell1=None
                elif self.width*.525<=x<=self.width*.875 and self.height*.2<=y<=self.height*.74:
                    cellHeight=self.height*.54/9
                    newSelectedCell2=int((y-self.height*.2)/cellHeight)
                    if self.selectedCell2==None:
                        self.selectedCell2=newSelectedCell2
                        self.selectedCell1=None
                        self.selectedCell3=None
                        self.selectedCell4=None
                    elif newSelectedCell2==self.selectedCell2:
                        self.selectedCell2=None
                    else:
                        self.playerSwap(newSelectedCell2,self.selectedCell2,self.game.homeTeam.lineup)
                        self.selectedCell2=None
                elif self.width*.125<=x<=self.width*.475 and self.height*.85<=y<=self.height*.91:
                    if self.selectedCell3==None:
                        self.selectedCell3=0
                        self.selectedCell1=None
                        self.selectedCell2=None
                        self.selectedCell4=None
                    elif self.selectedCell3!=None:
                        self.selectedCell3=None
                elif self.width*.525<=x<=self.width*.875 and self.height*.85<=y<=self.height*.91:
                    if self.selectedCell4==None:
                        self.selectedCell4=0
                        self.selectedCell1=None
                        self.selectedCell2=None
                        self.selectedCell3=None
                    elif self.selectedCell4!=None:
                        self.selectedCell4=None
                else:
                    self.selectedCell1=None
                    self.selectedCell2=None
                    self.selectedCell3=None
                    self.selectedCell4=None
            elif self.selectingPitcher:
                if self.width*.3<=x<=self.width*.7 and self.height*.3<=y<=self.height*.7:
                    cellHeight=self.height*.4/5
                    self.selectedCell5=int((y-self.height*.3)/cellHeight)
                else:
                    self.selectingPitcher=False
                    self.selectedCell3=None
                    self.selectedCell4=None
            else:
                if self.width*.3<=x<=self.width*.7 and self.height*.1<=y<=self.height*.9:
                    if self.selectedCell1!=None:
                        cellHeight=self.height*.8/len(self.game.awayTeam.fielders)
                        self.selectedCell6=int((y-self.height*.1)/cellHeight)
                    else:
                        cellHeight=self.height*.8/len(self.game.homeTeam.fielders)
                        self.selectedCell6=int((y-self.height*.1)/cellHeight)
                else:
                    self.selectingBatter=False
                    self.selectedCell2=None
                    self.selectedCell1=None
        if self.game.gameOver:
            if self.gameOverMenuRect.collidepoint(x,y):
                self.mPressed()
            elif self.gameOverBoxScoreRect.collidepoint(x,y):
                self.mode='Box Score'

    def playerSwap(self,index1,index2,lineup):
        lineup[index1],lineup[index2]=lineup[index2],lineup[index1]
        self.game.awayTeam.currBatter=self.game.awayTeam.lineup[self.game.awayTeam.index]
        self.game.homeTeam.currBatter=self.game.homeTeam.lineup[self.game.homeTeam.index]

    def inGameMouseReleased(self, x, y):
        pass

    def inGameMouseMotion(self, x, y):
        pass

    def inGameMouseDrag(self, x, y):
        pass

    def inGameKeyPressed(self, keyCode, modifier):
        if self.lineupScreen:
            if (self.selectedCell3!=None or self.selectedCell4!=None) and keyCode==99:
                self.selectingPitcher=True
            elif (self.selectedCell1!=None or self.selectedCell2!=None) and keyCode==99:
                self.selectingBatter=True
        if not self.game.gameOver:
            if keyCode==46:
                self.fps=int(self.fps*1.2)
            elif keyCode==44:
                self.fps=int(self.fps/1.2)
            if not self.ballBeingPitched and not self.ballInPlay and not self.displayDelay and self.delayF<=0:
                self.displayDelayTime=50
                self.playTimer=100
                if keyCode==32:
                    self.ballBeingPitched=True
                    self.ball=Ball(self.scaledBallImage,self.scaledShadowImage,self.fence)
            if keyCode==97:
                self.autoplay=not self.autoplay
            if keyCode==115:
                self.sim=True
            if keyCode==100:
                self.actionOnly=not self.actionOnly

    def inGameKeyReleased(self, keyCode, modifier):
        pass

    def inGameTimerFired(self, dt):
        if self.sim:
            while(not self.game.gameOver):
                self.game.makePitch()
        if not self.game.gameOver or self.ballInPlay or self.displayDelay:
            if self.displayDelay:
                self.displayDelayTime-=1
                if self.displayDelayTime<=0:
                    self.displayDelay=False
            if self.ballBeingPitched or self.delay>0:
                self.makePitch()
                self.delay-=1
            if self.ballInPlay or self.delayF>0:
                self.delayF-=1
                self.ball.move()
                if self.delayF<=0 and self.ballInPlay:
                    self.playTimer-=1
                    self.nearestDestFielder,self.nearestRestFielder=self.findNearestFielder()
                    if self.nearestDestFielder!=self.nearestRestFielder:
                        self.nearestDestFielder.calculateMove(self.destX,self.destY)
                        self.nearestRestFielder.calculateMove(self.restX,self.restY)
                        self.nearestRestFielder.move(self.ball)
                        self.nearestDestFielder.move(self.ball)
                    else:
                        if not self.ball.groundball:
                            self.nearestDestFielder.calculateMove(self.destX,self.destY)
                        else:
                            self.nearestDestFielder.calculateMove(self.ball.x,self.ball.y)
                        self.nearestDestFielder.move(self.ball)
                    nearestDestFielderRect=[self.nearestDestFielder.x-self.nearestDestFielder.image.get_width()/2,self.nearestDestFielder.y-self.nearestDestFielder.image.get_height()/2,self.nearestDestFielder.image.get_width(),self.nearestDestFielder.image.get_height()]
                    nearestRestFielderRect=[self.nearestRestFielder.x-self.nearestRestFielder.image.get_width()/2,self.nearestRestFielder.y-self.nearestDestFielder.image.get_height()/2,self.nearestRestFielder.image.get_width(),self.nearestRestFielder.image.get_height()]
                    self.fence.fenceContact(self.ball.x,self.ball.y,self.ball.z-5)
                    if (((nearestDestFielderRect[0]<=self.ball.x<=nearestDestFielderRect[0]+nearestDestFielderRect[2] and nearestDestFielderRect[1]<=self.ball.y<=nearestDestFielderRect[1]+nearestDestFielderRect[3]) or (nearestRestFielderRect[0]<=self.ball.x<=nearestRestFielderRect[0]+nearestRestFielderRect[2] and nearestRestFielderRect[1]<=self.ball.y<=nearestRestFielderRect[1]+nearestRestFielderRect[3])) and self.ball.z<=0) or self.playTimer<=0:
                        self.ballInPlay=False
                        self.C.x,self.C.y=self.CStart
                        self.fB.x,self.fB.y=self.fBStart
                        self.sB.x,self.sB.y=self.sBStart
                        self.tB.x,self.tB.y=self.tBStart
                        self.SS.x,self.SS.y=self.SSStart
                        self.LF.x,self.LF.y=self.LFStart
                        self.CF.x,self.CF.y=self.CFStart
                        self.RF.x,self.RF.y=self.RFStart
                        self.P.x,self.P.y=self.PStart
                        self.displayDelay=True
                        self.displayDelayTime=50
                        self.playTimer=100
                        self.update()
                elif self.delayF==1:
                    self.displayDelay=True
                    self.displayDelayTime=50
                    self.playTimer=100
                    self.update()
            if not self.ballBeingPitched and not self.ballInPlay and not self.displayDelay and self.delayF<=0 and self.autoplay:
                self.displayDelayTime=50
                self.playTimer=100
                self.ballBeingPitched=True
                self.ball=Ball(self.scaledBallImage,self.scaledShadowImage,self.fence)

    def findNearestFielder(self):
        self.destX,self.destY=findBallDestination(self.ball.x,self.ball.y,self.ball.z,self.ball.dx,self.ball.dy,self.ball.dz)
        self.restX,self.restY=findBallRest(self.destX,self.destY,self.ball.dx,self.ball.dy)
        # print('Destination',self.destX,self.destY)
        # print('Rest',self.restX,self.restY)
        closestDestFielder,dist=None,None
        for player in self.fielders:
            player.dist=distance(player.x,player.y,self.destX,self.destY)
            if dist==None or player.dist<dist:
                closestDestFielder=player
                dist=player.dist
        closesRestFielder,dist=None,None
        for player in self.fielders:
            player.dist=distance(player.x,player.y,self.restX,self.restY)
            if dist==None or player.dist<dist:
                closesRestFielder=player
                dist=player.dist
        if self.playType in ['HOMERUN','TRIPLE','DOUBLE']:
            closesRestFielder.speed=1.4
            closestDestFielder.speed=1.4
        else:
            closesRestFielder.speed=2
            closestDestFielder.speed=2
        return closestDestFielder,closesRestFielder
    
    def makePitch(self):
        self.ball.pitch()
        if self.ball.y>=572 and self.ballBeingPitched:
            currentState=self.game.bases
            result=self.game.makePitch()
            #result=self.testCertainPlays(['Y,-3.75,5,2,GROUNDOUT','Y,-2.5,5,1,GROUNDOUT','Y,-1.5,5,2,GROUNDOUT','Y,0,8,2,GROUNDOUT','Y,1.5,5,2,GROUNDOUT','Y,2.5,5,2,GROUNDOUT','Y,4,5,2,GROUNDOUT','Y,.5,2,2,GROUNDOUT','Y,-.5,2,2,GROUNOUT'])
            self.i+=1
            self.interpreter(result,currentState)
            self.ballBeingPitched=False

    def testCertainPlays(self,plays):
        return plays[self.i%len(plays)]


    def interpreter(self,result,currentState):
        result=result.split(',')
        self.ball.dx,self.ball.dy,self.ball.dz=eval(result[1]),eval(result[2]),eval(result[3])
        self.playType=result[4]
        if result[0]=='Y':
            self.ballInPlay=True
        elif result[0]=='N':
            if not self.actionOnly or 'STRIKEOUT' in self.playType or 'WALK' in self.playType:
                self.ballInPlay=False
                if self.playType=='FOUL':
                    self.delayF=40
                else:
                    self.delay=7
                    self.displayDelay=True
                    self.displayDelayTime=50
                    self.playTimer=100
                    self.update()
            else:
                self.makePitch()

    def update(self):
        self.gameOver=self.game.gameOver
        self.outs=self.game.outs
        self.inning=self.game.inning
        self.topInning=self.game.topInning
        self.battingTeam=self.game.battingTeam
        self.pitchingTeam=self.game.pitchingTeam
        self.battingTeamIndex=self.game.battingTeamIndex
        self.pitchingTeamIndex=self.game.pitchingTeamIndex
        self.score=self.game.score
        self.hits=self.game.hits
        self.errors=self.game.errors
        self.count=self.game.count
        self.bases=self.game.bases
        self.battingTeam.index=self.game.battingTeam.index
        self.homeIndex=self.game.homeTeam.index
        self.awayIndex=self.game.awayTeam.index

    def inGameRedrawAll(self, screen):
        if self.lineupScreen:
            scaledLineupImage=pygame.transform.scale(self.lineupImage, (self.width,self.height))
            screen.blit(scaledLineupImage,(0,0))
            self.lineupBackgroundSurface.set_alpha(150)
            self.lineupBackgroundSurface.fill(self.lineupBackgroundSurfaceColor)
            if self.selectedTeams[0]=='ATL' or self.selectedTeams[0]=='SFG':
                logoScaler1=.28
            else:
                logoScaler1=.4
            if self.selectedTeams[1]=='ATL' or self.selectedTeams[0]=='SFG':
                logoScaler2=.28
            else:
                logoScaler2=.4
            scaledTeam1Logo=pygame.transform.scale(self.selectedTeams[0].logo,(int(self.height*logoScaler1*self.selectedTeams[0].logoRatio),int(self.height*logoScaler1)))
            scaledTeam2Logo=pygame.transform.scale(self.selectedTeams[1].logo,(int(self.height*logoScaler2*self.selectedTeams[1].logoRatio),int(self.height*logoScaler2)))
            self.lineupBackgroundSurface.blit(scaledTeam1Logo,(self.lineupBackgroundSurface.get_width()*.27-scaledTeam1Logo.get_width()/2,self.lineupBackgroundSurface.get_width()*.27-scaledTeam1Logo.get_height()/2))
            self.lineupBackgroundSurface.blit(scaledTeam2Logo,(self.lineupBackgroundSurface.get_width()*.73-scaledTeam2Logo.get_width()/2,self.lineupBackgroundSurface.get_width()*.27-scaledTeam2Logo.get_height()/2))
            screen.blit(self.lineupBackgroundSurface,(self.width*.075,self.height*.05))
            self.displayText(screen,self.selectedTeams[0].fullName,self.pageTitleFont,WHITE,center=(self.width*.3,self.height*.15))
            self.displayText(screen,self.selectedTeams[1].fullName,self.pageTitleFont,WHITE,center=(self.width*.7,self.height*.15))
            self.lineupGrid(screen,self.width*.35,self.height*.54,self.selectedTeams[0].colors[0],self.game.awayTeam,self.width*.125,self.height*.2,9,self.selectedCell1)
            self.lineupGrid(screen,self.width*.35,self.height*.54,self.selectedTeams[1].colors[0],self.game.homeTeam,self.width*.525,self.height*.2,9,self.selectedCell2)
            self.lineupGrid(screen,self.width*.35,self.height*.06,self.selectedTeams[0].colors[0],self.game.awayTeam,self.width*.125,self.height*.85,1,self.selectedCell3)
            self.lineupGrid(screen,self.width*.35,self.height*.06,self.selectedTeams[1].colors[0],self.game.homeTeam,self.width*.525,self.height*.85,1,self.selectedCell4)
            if self.lineupPlayRect.collidepoint(pygame.mouse.get_pos()) and not (self.selectingPitcher or self.selectingBatter):
                self.lineupPlayRectColor=BRIGHT_GREEN
            else:
                self.lineupPlayRectColor=DULL_GREEN
            pygame.draw.rect(screen,self.lineupPlayRectColor,self.lineupPlayRect)
            self.displayText(screen,'PLAY',self.pageTitleFont,WHITE,center=self.lineupPlayRect.center)
            if self.lineupBackRect.collidepoint(pygame.mouse.get_pos()) and not (self.selectingPitcher or self.selectingBatter):
                self.lineupBackRectColor=BRIGHT_GREEN
            else:
                self.lineupBackRectColor=DULL_GREEN
            pygame.draw.rect(screen,self.lineupBackRectColor,self.lineupBackRect)
            self.displayText(screen,'BACK',self.buttonFont,WHITE,center=self.lineupBackRect.center)
            if self.selectingPitcher:
                if self.selectedCell3!=None:
                    self.selectPitcher(screen,self.game.awayTeam)
                else:
                    self.selectPitcher(screen,self.game.homeTeam)
            if self.selectingBatter:
                if self.selectedCell1!=None:
                    self.selectBatter(screen,self.game.awayTeam)
                else:
                    self.selectBatter(screen,self.game.homeTeam)
        else:
            if not self.game.gameOver or self.ballInPlay or self.displayDelay:
                self.fieldRedraw(screen)
                self.sideBarRedraw(screen)
            else:
                if self.game.score[0]>self.game.score[1]:
                    self.winningTeam=self.game.awayTeam.team
                else:
                    self.winningTeam=self.game.homeTeam.team
                scaledBackgroundImage=pygame.transform.scale(self.backgroundImage, (self.width,self.height))
                screen.blit(scaledBackgroundImage,(0,0))
                boxScoreRect=pygame.Rect(self.width*.05,self.height*.1,self.width*.85,self.height*.2)
                pygame.draw.rect(screen,GRAY,boxScoreRect)
                self.boxScore(screen)
                if self.winningTeam=='ATL' or self.winningTeam=='SFG' or self.winningTeam=='MIL':
                    logoScaler=.50
                else:
                    logoScaler=.75
                scaledWinnerLogo=pygame.transform.scale(self.winningTeam.logo, (int(self.height*logoScaler*self.winningTeam.logoRatio),int(self.height*logoScaler)))
                screen.blit(scaledWinnerLogo,(self.width*.5-scaledWinnerLogo.get_width()/2,self.height*.7-scaledWinnerLogo.get_height()/2))
                winnersurf=pygame.Surface((int(self.width),int(self.height*.2)))
                winnersurf.set_alpha(200)
                winnersurf.fill(self.winningTeam.colors[0])
                screen.blit(winnersurf,(0,self.height*.35))
                self.displayText(screen,'The '+ self.winningTeam.name+' Win!!',self.hugeTextFont,self.winningTeam.colors[1],center=(self.width*.5,self.height*.45))
                if self.gameOverMenuRect.collidepoint(pygame.mouse.get_pos()):
                    self.gameOverMenuRectColor=BRIGHT_GREEN
                else:
                    self.gameOverMenuRectColor=DULL_GREEN
                pygame.draw.rect(screen, self.gameOverMenuRectColor, self.gameOverMenuRect)
                self.displayText(screen, 'MENU',self.buttonFont,WHITE,center=self.gameOverMenuRect.center)
                if self.gameOverBoxScoreRect.collidepoint(pygame.mouse.get_pos()):
                    self.gameOverBoxScoreRectColor=BRIGHT_GREEN
                else:
                    self.gameOverBoxScoreRectColor=DULL_GREEN
                pygame.draw.rect(screen, self.gameOverBoxScoreRectColor, self.gameOverBoxScoreRect)
                self.displayText(screen, 'BOX SCORE',self.buttonFont,WHITE,center=self.gameOverBoxScoreRect.center)

    def selectPitcher(self,screen,team):
        self.pitchersRect=pygame.Rect(self.width*.3,self.height*.3,self.width*.4,self.height*.4)
        pygame.draw.rect(screen,LIGHT_GRAY,self.pitchersRect)
        cellHeight=self.pitchersRect.height/len(team.team.rotation)
        for i,pitcher in enumerate(team.team.rotation):
            rect=pygame.Rect(self.width*.3,self.height*.3+i*cellHeight,self.width*.4,cellHeight)
            if rect.collidepoint(pygame.mouse.get_pos()):
                pygame.draw.rect(screen,SOLID_YELLOW,rect)
                self.displayText(screen,pitcher.name,self.normalTextFont,BLACK,center=rect.center)
                self.displayText(screen,'SP',self.normalTextFont,BLACK,center=(rect.center[0]-self.width*.15,rect.center[1]))
            else:
                self.displayText(screen,pitcher.name,self.normalTextFont,WHITE,center=rect.center)
                self.displayText(screen,'SP',self.normalTextFont,WHITE,center=(rect.center[0]-self.width*.15,rect.center[1]))
        previousStarter=team.startingPitcher
        if self.selectedCell5!=None:
            team.startingPitcher=team.team.rotation[self.selectedCell5]
            team.inGamePlayers[team.startingPitcher.name]=GamePlayer(team.startingPitcher,'SP')
            if not self.game.dh:
                index=team.lineup.index(previousStarter)
                team.lineup.remove(previousStarter)
                team.lineup.insert(index,team.startingPitcher)
            team.currPitcher=team.startingPitcher
            self.selectedCell5=None
            self.selectedCell4=None
            self.selectedCell3=None
            self.selectingPitcher=False

    def selectBatter(self,screen,team):
        self.battersRect=pygame.Rect(self.width*.3,self.height*.1,self.width*.4,self.height*.8)
        pygame.draw.rect(screen,LIGHT_GRAY,self.battersRect)
        cellHeight=self.battersRect.height/len(team.fielders)
        for i,fielder in enumerate(team.fielders):
            rect=pygame.Rect(self.width*.3,self.height*.1+i*cellHeight,self.width*.4,cellHeight)
            if rect.collidepoint(pygame.mouse.get_pos()):
                pygame.draw.rect(screen,SOLID_YELLOW,rect)
                self.displayText(screen,fielder.name,self.normalTextFont,BLACK,center=rect.center)
                self.displayText(screen,fielder.pos,self.normalTextFont,BLACK,center=(rect.center[0]-self.width*.15,rect.center[1]))
            else:
                self.displayText(screen,fielder.name,self.normalTextFont,WHITE,center=rect.center)
                self.displayText(screen,fielder.pos,self.normalTextFont,WHITE,center=(rect.center[0]-self.width*.15,rect.center[1]))
        if self.selectedCell1!=None:
            previousPlayer=team.lineup[self.selectedCell1]
            if self.selectedCell6!=None:
                if team.fielders[self.selectedCell6] in team.lineup:
                    index=team.lineup.index(team.fielders[self.selectedCell6])
                    team.inGamePlayers[previousPlayer.name].gamePos,team.inGamePlayers[team.lineup[index].name].gamePos=team.inGamePlayers[team.lineup[index].name].gamePos,team.inGamePlayers[team.lineup[self.selectedCell1].name].gamePos
                    self.playerSwap(self.selectedCell1,index,team.lineup)
                else:
                    team.inGamePlayers[team.fielders[self.selectedCell6].name]=GamePlayer(team.fielders[self.selectedCell6],team.inGamePlayers[previousPlayer.name].gamePos)
                    team.lineup.remove(previousPlayer)
                    team.lineup.insert(self.selectedCell1,team.fielders[self.selectedCell6])
                team.currBatter==team.lineup[team.index]
                self.selectedCell6=None
                self.selectedCell2=None
                self.selectedCell1=None
                self.selectingBatter=False
        elif self.selectedCell2!=None:
            previousPlayer=team.lineup[self.selectedCell2]
            if self.selectedCell6!=None:
                if team.fielders[self.selectedCell6] in team.lineup:
                    index=team.lineup.index(team.fielders[self.selectedCell6])
                    team.inGamePlayers[previousPlayer.name].gamePos,team.inGamePlayers[team.lineup[index].name].gamePos=team.inGamePlayers[team.lineup[index].name].gamePos,team.inGamePlayers[team.lineup[self.selectedCell2].name].gamePos
                    self.playerSwap(self.selectedCell2,index,team.lineup)
                else:
                    team.inGamePlayers[team.fielders[self.selectedCell6].name]=GamePlayer(team.fielders[self.selectedCell6],team.inGamePlayers[previousPlayer.name].gamePos)
                    team.lineup.remove(previousPlayer)
                    team.lineup.insert(self.selectedCell2,team.fielders[self.selectedCell6])
                team.currBatter==team.lineup[team.index]
                self.selectedCell6=None
                self.selectedCell2=None
                self.selectedCell1=None
                self.selectingBatter=False

    def sideBarRedraw(self,screen):
        self.selectedCell1=self.awayIndex%9
        self.selectedCell2=self.homeIndex%9
        self.sideBarWidth=self.width-self.fieldImageWidth
        pygame.draw.rect(screen,self.sideBarColor,self.sideBarRect)
        if self.topInning:
            pygame.draw.polygon(screen,WHITE,[(self.fieldImageWidth+self.sideBarWidth*.13,self.height*.4),(self.fieldImageWidth+self.sideBarWidth*.17,self.height*.4),(self.fieldImageWidth+self.sideBarWidth*.15,self.height*.37)])
        else:
            pygame.draw.polygon(screen,WHITE,[(self.fieldImageWidth+self.sideBarWidth*.13,self.height*.4),(self.fieldImageWidth+self.sideBarWidth*.17,self.height*.4),(self.fieldImageWidth+self.sideBarWidth*.15,self.height*.43)])
        self.displayText(screen,str(self.inning),self.pageTitleFont,WHITE,center=(self.fieldImageWidth+self.sideBarWidth*.05,self.height*.4))
        if self.bases[0]!=None: self.fBaseColor=SOLID_YELLOW
        else: self.fBaseColor=LIGHT_GRAY
        if self.bases[1]!=None: self.sBaseColor=SOLID_YELLOW
        else: self.sBaseColor=LIGHT_GRAY
        if self.bases[2]!=None: self.tBaseColor=SOLID_YELLOW
        else: self.tBaseColor=LIGHT_GRAY
        pygame.draw.polygon(screen,self.fBaseColor,[(self.fieldImageWidth+self.sideBarWidth*.35,self.height*.42),(self.fieldImageWidth+self.sideBarWidth*.4,self.height*.38),(self.fieldImageWidth+self.sideBarWidth*.45,self.height*.42),(self.fieldImageWidth+self.sideBarWidth*.4,self.height*.46)])
        pygame.draw.polygon(screen,self.sBaseColor,[(self.fieldImageWidth+self.sideBarWidth*.3,self.height*.38),(self.fieldImageWidth+self.sideBarWidth*.35,self.height*.34),(self.fieldImageWidth+self.sideBarWidth*.4,self.height*.38),(self.fieldImageWidth+self.sideBarWidth*.35,self.height*.42)])
        pygame.draw.polygon(screen,self.tBaseColor,[(self.fieldImageWidth+self.sideBarWidth*.25,self.height*.42),(self.fieldImageWidth+self.sideBarWidth*.3,self.height*.46),(self.fieldImageWidth+self.sideBarWidth*.35,self.height*.42),(self.fieldImageWidth+self.sideBarWidth*.3,self.height*.38)])
        pygame.draw.polygon(screen,BLACK,[(self.fieldImageWidth+self.sideBarWidth*.35,self.height*.42),(self.fieldImageWidth+self.sideBarWidth*.4,self.height*.38),(self.fieldImageWidth+self.sideBarWidth*.45,self.height*.42),(self.fieldImageWidth+self.sideBarWidth*.4,self.height*.46)],1)
        pygame.draw.polygon(screen,BLACK,[(self.fieldImageWidth+self.sideBarWidth*.3,self.height*.38),(self.fieldImageWidth+self.sideBarWidth*.35,self.height*.34),(self.fieldImageWidth+self.sideBarWidth*.4,self.height*.38),(self.fieldImageWidth+self.sideBarWidth*.35,self.height*.42)],1)
        pygame.draw.polygon(screen,BLACK,[(self.fieldImageWidth+self.sideBarWidth*.25,self.height*.42),(self.fieldImageWidth+self.sideBarWidth*.3,self.height*.46),(self.fieldImageWidth+self.sideBarWidth*.35,self.height*.42),(self.fieldImageWidth+self.sideBarWidth*.3,self.height*.38)],1)
        self.drawScoreboard(screen)
        self.displayText(screen,str(self.count[0])+'-'+str(self.count[1]),self.pageTitleFont,WHITE,center=(self.fieldImageWidth+self.sideBarWidth*.7,self.height*.36))
        if self.outs>=1: self.out1Color=SOLID_YELLOW
        else: self.out1Color=LIGHT_GRAY
        if self.outs>=2: self.out2Color=SOLID_YELLOW
        else: self.out2Color=LIGHT_GRAY
        self.displayText(screen,'OUTS',self.normalTextFont,WHITE,center=(self.fieldImageWidth+self.sideBarWidth*.6,self.height*.45))
        pygame.draw.circle(screen,self.out1Color,(int(self.fieldImageWidth+self.sideBarWidth*.8),int(self.height*.45)),int(self.sideBarWidth*.05))
        pygame.draw.circle(screen,self.out2Color,(int(self.fieldImageWidth+self.sideBarWidth*.9),int(self.height*.45)),int(self.sideBarWidth*.05))
        self.lineupGrid(screen,self.sideBarWidth*.8,self.height*.2,WHITE,self.game.awayTeam,self.fieldImageWidth+self.sideBarWidth*.1,self.height*.525,9,self.selectedCell1)
        self.lineupGrid(screen,self.sideBarWidth*.8,self.height*.2,WHITE,self.game.homeTeam,self.fieldImageWidth+self.sideBarWidth*.1,self.height*.775,9,self.selectedCell2)
        pygame.draw.rect(screen,self.game.awayTeam.team.colors[0],self.sideBarAwayRect)
        pygame.draw.rect(screen,self.game.homeTeam.team.colors[0],self.sideBarHomeRect)
        self.displayText(screen,self.game.awayTeam.team.fullName,self.normalTextFont,self.game.awayTeam.team.colors[1],pos=(self.fieldImageWidth+self.sideBarWidth*.1,self.height*.4775))
        self.displayText(screen,self.game.homeTeam.team.fullName,self.normalTextFont,self.game.homeTeam.team.colors[1],pos=(self.fieldImageWidth+self.sideBarWidth*.1,self.height*.7275))

    def drawScoreboard(self,screen):
        awayRect=pygame.Rect(self.fieldImageWidth+self.sideBarWidth*.1,self.height*.1,self.sideBarWidth*.8,self.height*.1)
        homeRect=pygame.Rect(self.fieldImageWidth+self.sideBarWidth*.1,self.height*.2,self.sideBarWidth*.8,self.height*.1)
        pygame.draw.rect(screen,self.game.awayTeam.team.colors[0],awayRect)
        pygame.draw.rect(screen,self.game.homeTeam.team.colors[0],homeRect)
        self.displayText(screen,self.game.awayTeam.team.abbrev,self.pageTitleFont,WHITE,pos=(self.fieldImageWidth+self.sideBarWidth*.12,self.height*.115))
        self.displayText(screen,self.game.homeTeam.team.abbrev,self.pageTitleFont,WHITE,pos=(self.fieldImageWidth+self.sideBarWidth*.12,self.height*.215))
        self.displayText(screen,'R',self.pageTitleFont,WHITE,center=(self.fieldImageWidth+self.sideBarWidth*.5,self.height*.05))
        self.displayText(screen,'H',self.pageTitleFont,WHITE,center=(self.fieldImageWidth+self.sideBarWidth*.65,self.height*.05))
        self.displayText(screen,'E',self.pageTitleFont,WHITE,center=(self.fieldImageWidth+self.sideBarWidth*.8,self.height*.05))
        self.displayText(screen,str(self.game.score[0]),self.pageTitleFont,WHITE,center=(self.fieldImageWidth+self.sideBarWidth*.5,self.height*.15))
        self.displayText(screen,str(self.game.score[1]),self.pageTitleFont,WHITE,center=(self.fieldImageWidth+self.sideBarWidth*.5,self.height*.25))
        self.displayText(screen,str(self.game.hits[0]),self.pageTitleFont,WHITE,center=(self.fieldImageWidth+self.sideBarWidth*.65,self.height*.15))
        self.displayText(screen,str(self.game.hits[1]),self.pageTitleFont,WHITE,center=(self.fieldImageWidth+self.sideBarWidth*.65,self.height*.25))
        self.displayText(screen,str(self.game.errors[0]),self.pageTitleFont,WHITE,center=(self.fieldImageWidth+self.sideBarWidth*.8,self.height*.15))
        self.displayText(screen,str(self.game.errors[1]),self.pageTitleFont,WHITE,center=(self.fieldImageWidth+self.sideBarWidth*.8,self.height*.25))

    def createFielders(self):
        fielderRatio=self.fielderImage.get_width()/self.fielderImage.get_height()
        catcherRatio=self.catcherImage.get_width()/self.catcherImage.get_height()
        pitcherRatio=self.pitcherImage.get_width()/self.pitcherImage.get_height()
        scaledFielderImage=pygame.transform.scale(self.fielderImage, (int(20*fielderRatio),20))
        scaledCatcherImage=pygame.transform.scale(self.catcherImage, (int(20*catcherRatio),20))
        scaledPitcherImage=pygame.transform.scale(self.pitcherImage, (int(20*pitcherRatio),25))
        self.C=AnimatedPlayer(scaledCatcherImage,self.CStart,self.fence)
        self.fB=AnimatedPlayer(scaledFielderImage,self.fBStart,self.fence)
        self.sB=AnimatedPlayer(scaledFielderImage,self.sBStart,self.fence)
        self.tB=AnimatedPlayer(scaledFielderImage,self.tBStart,self.fence)
        self.SS=AnimatedPlayer(scaledFielderImage,self.SSStart,self.fence)
        self.LF=AnimatedPlayer(scaledFielderImage,self.LFStart,self.fence)
        self.CF=AnimatedPlayer(scaledFielderImage,self.CFStart,self.fence)
        self.RF=AnimatedPlayer(scaledFielderImage,self.RFStart,self.fence)
        self.P=AnimatedPlayer(scaledPitcherImage,self.PStart,self.fence)
        self.fielders=[self.C,self.fB,self.sB,self.tB,self.SS,self.LF,self.CF,self.RF,self.P]

    def createBatter(self):
        batterRatio=self.batterImage.get_width()/self.batterImage.get_height()
        scaledBatterImage=pygame.transform.scale(self.batterImage, (int(20*batterRatio),20))
        self.AB=AnimatedPlayer(scaledBatterImage,self.ABStart,self.fence)

    def fieldRedraw(self,screen):
        scaledFieldImage=pygame.transform.scale(self.fieldImage, (self.fieldImageWidth,self.height))
        screen.blit(scaledFieldImage,(0,0))
        pygame.draw.rect(screen,self.battingTeam.team.colors[0],self.currBatterRect)
        pygame.draw.rect(screen,self.pitchingTeam.team.colors[0],self.currPitcherRect)
        self.displayText(screen,'BATTER',self.smallTextFont,self.battingTeam.team.colors[1],pos=(self.fieldImageWidth*.01,self.height*.91))
        self.displayText(screen,'PITCHER',self.smallTextFont,self.pitchingTeam.team.colors[1],pos=(self.fieldImageWidth*.61,self.height*.91))
        self.displayText(screen,'#'+self.battingTeam.currBatter.num,self.slightSmallTextFont,self.battingTeam.team.colors[1],center=(self.fieldImageWidth*.37,self.height*.92))
        self.displayText(screen,'#'+self.pitchingTeam.currPitcher.num,self.slightSmallTextFont,self.pitchingTeam.team.colors[1],center=(self.fieldImageWidth*.97,self.height*.92))
        self.displayText(screen,self.battingTeam.currBatter.name,self.normalTextFont,self.battingTeam.team.colors[1],center=(self.fieldImageWidth*.22,self.height*.95))
        self.displayText(screen,self.pitchingTeam.currPitcher.name,self.normalTextFont,self.pitchingTeam.team.colors[1],center=(self.fieldImageWidth*.82,self.height*.95))
        self.displayText(screen,self.battingTeam.inGamePlayers[self.battingTeam.currBatter.name].gamePos,self.normalTextFont,self.battingTeam.team.colors[1],center=(self.fieldImageWidth*.03,self.height*.95))
        self.displayText(screen,self.pitchingTeam.inGamePlayers[self.pitchingTeam.currPitcher.name].gamePos,self.normalTextFont,self.pitchingTeam.team.colors[1],center=(self.fieldImageWidth*.63,self.height*.95))
        FPSRect=pygame.Rect(0,0,40,20)
        pygame.draw.rect(screen,BRIGHT_GREEN,FPSRect)
        fps=str(self.fps/30)
        self.displayText(screen,'x'+fps[:4],self.slightSmallTextFont,WHITE,center=FPSRect.center)
        if self.actionOnly:
            AORect=pygame.Rect(self.fieldImageWidth-40,0,20,20)
            pygame.draw.rect(screen,BRIGHT_GREEN,AORect)
            self.displayText(screen,'D',self.slightSmallTextFont,WHITE,center=AORect.center)
        if self.autoplay:
            APRect=pygame.Rect(self.fieldImageWidth-20,0,20,20)
            pygame.draw.rect(screen,BRIGHT_GREEN,APRect)
            self.displayText(screen,'A',self.slightSmallTextFont,WHITE,center=APRect.center)
        if self.displayDelay:
            pygame.draw.rect(screen,RED,self.fieldDisplayRect)
            self.displayText(screen,self.playType,self.pageTitleFont,WHITE,center=(self.fieldDisplayRect.center))
        for player in self.fielders:
            screen.blit(player.image,(int(player.x-player.image.get_width()/2),int(player.y-player.image.get_height()/2)))
        screen.blit(self.AB.image,(int(self.AB.x-self.AB.image.get_width()/2),int(self.AB.y-self.AB.image.get_height()/2)))
        if self.ballBeingPitched or self.delay>0 or self.ballInPlay or self.delayF>0:
            screen.blit(self.ball.image,(int(self.ball.x-self.ball.image.get_width()/2),int(self.ball.y-self.ball.image.get_height()/2)-self.ball.z*.5))
            if self.ball.z!=0:
                screen.blit(self.ball.shadowImage,(int(self.ball.x-self.ball.shadowImage.get_width()/2),int(self.ball.y-self.ball.shadowImage.get_height()/2)))

    def lineupGrid(self,screen,width,height,color,team,left,top,cells,selectedCell=None):
        cellWidth,cellHeight=width,height/cells
        for x in range(cells):
            cellTop=top+x*cellHeight
            cell=pygame.Rect(left,cellTop,cellWidth,cellHeight)
            surf=pygame.Surface((cellWidth,cellHeight))
            if selectedCell==None or selectedCell!=x:
                surf.set_alpha(150)
                surf.fill(LIGHT_YELLOW)
            else:
                surf.fill(SOLID_YELLOW)
            screen.blit(surf,(left,cellTop))
            if cellHeight>self.height*.04:
                pygame.draw.rect(screen,color,cell,2)
            else:
                pygame.draw.rect(screen,color,cell,2)
            if cells==9:
                if cellHeight>self.height*.04:
                    self.displayText(screen,team.inGamePlayers[team.lineup[x].name].gamePos,self.normalTextFont,BLACK,pos=(left+cellWidth*.05,cellTop+cellHeight*.1))
                    self.displayText(screen,team.inGamePlayers[team.lineup[x].name].name,self.normalTextFont,BLACK,center=(left+cellWidth*.5,cellTop+cellHeight*.5))
                else:
                    self.displayText(screen,team.inGamePlayers[team.lineup[x].name].gamePos,self.smallTextFont,BLACK,pos=(left+cellWidth*.05,cellTop+cellHeight*.1))
                    self.displayText(screen,team.inGamePlayers[team.lineup[x].name].name,self.smallTextFont,BLACK,center=(left+cellWidth*.4,cellTop+cellHeight*.5))
                    content=self.createStats(team.inGamePlayers[team.lineup[x].name])
                    self.displayText(screen,content,self.smallTextFont,BLACK,pos=(left+cellWidth*.7,cellTop+cellHeight*.1))
            elif cells==1:
                if cellHeight>self.height*.04:
                    self.displayText(screen,'SP',self.normalTextFont,BLACK,pos=(left+cellWidth*.05,cellTop+cellHeight*.1))
                    self.displayText(screen,team.startingPitcher.name,self.normalTextFont,BLACK,center=(left+cellWidth*.5,cellTop+cellHeight*.5))
                else:
                    self.displayText(screen,'SP',self.smallTextFont,BLACK,pos=(left+cellWidth*.05,cellTop+cellHeight*.1))
                    self.displayText(screen,team.startingPitcher.name,self.smallTextFont,BLACK,center=(left+cellWidth*.5,cellTop+cellHeight*.5))

    def createStats(self,player):
        d={0:'2B',1:'3B',2:'HR',3:'RBI',4:'R',5:'BB',6:'K'}
        result=str(player.H)+'-'+str(player.AB)
        stats=[player.d,player.t,player.HR,player.RBI,player.R,player.BB,player.SO]
        for i,stat in enumerate(stats):
            if stat==0 or len(result.split(','))>=5:
                pass
            else:
                if stat==1:
                    result+=', %s'%d[i]
                else:
                    result+=', %d %s'%(stat,d[i])
        return result



#BOX SCORE


    def boxScoreMousePressed(self, x, y):
        if self.boxScoreBackRect.collidepoint(x,y):
            self.mode='In-game'
        elif self.boxScoreMenuRect.collidepoint(x,y):
            self.mPressed()

    def boxScoreRedrawAll(self, screen):
        scaledBackgroundImage=pygame.transform.scale(self.backgroundImage, (self.width,self.height))
        screen.blit(scaledBackgroundImage,(0,0))
        boxScoreRect=pygame.Rect(self.width*.05,self.height*.1,self.width*.85,self.height*.2)
        pygame.draw.rect(screen,GRAY,boxScoreRect)
        self.boxScore(screen)
        awayTeamRect=pygame.Rect(0,self.height*.35,self.width*.45,self.height*.1)
        pygame.draw.rect(screen,self.game.awayTeam.team.colors[0],awayTeamRect)
        self.displayText(screen,self.game.awayTeam.team.fullName,self.pageTitleFont,self.game.awayTeam.team.colors[1],center=(awayTeamRect.center))
        self.individualBoxScore(screen,self.game.awayTeam,0,self.height*.45,self.width*.45,self.height*.4)
        homeTeamRect=pygame.Rect(self.width*.55,self.height*.35,self.width*.45,self.height*.1)
        pygame.draw.rect(screen,self.game.homeTeam.team.colors[0],homeTeamRect)
        self.displayText(screen,self.game.homeTeam.team.fullName,self.pageTitleFont,self.game.homeTeam.team.colors[1],center=(homeTeamRect.center))
        self.individualBoxScore(screen,self.game.homeTeam,self.width*.55,self.height*.45,self.width*.45,self.height*.4)
        if self.boxScoreBackRect.collidepoint(pygame.mouse.get_pos()):
            self.boxScoreBackRectColor=BRIGHT_GREEN
        else:
            self.boxScoreBackRectColor=DULL_GREEN
        pygame.draw.rect(screen, self.boxScoreBackRectColor, self.boxScoreBackRect)
        self.displayText(screen, 'BACK',self.buttonFont,WHITE,center=self.boxScoreBackRect.center)
        if self.boxScoreMenuRect.collidepoint(pygame.mouse.get_pos()):
            self.boxScoreMenuRectColor=BRIGHT_GREEN
        else:
            self.boxScoreMenuRectColor=DULL_GREEN
        pygame.draw.rect(screen, self.boxScoreMenuRectColor, self.boxScoreMenuRect)
        self.displayText(screen, 'MENU',self.buttonFont,WHITE,center=self.boxScoreMenuRect.center)


    def individualBoxScore(self,screen,team,left,top,width,height):
        backRect=pygame.Rect(left,top,width,height)
        pygame.draw.rect(screen,WHITE,backRect)
        batterRows=len(team.lineup)+2
        pitcherRows=len(team.pitchedPitchers)+1
        batterCellHeight=height*.75/batterRows
        batterCellFont=pygame.font.SysFont('Arial',int(batterCellHeight*.8))
        for i in range(batterRows):
            if i==0:
                row0Rect=pygame.Rect(left,top,width,batterCellHeight)
                pygame.draw.rect(screen,LIGHT_GRAY,row0Rect)
                row=['Player','AB','R','H','2B','3B','HR','RBI','BB','SO']
                batterCellFont.set_bold(True)
            elif i==10:
                batterCellFont.set_bold(True)
                row=[]
                for stat in range(9):
                    total=0
                    for player in team.lineup:
                        if stat==0:
                            total+=team.inGamePlayers[player.name].AB
                        elif stat==1:
                            total+=team.inGamePlayers[player.name].R
                        elif stat==2:
                            total+=team.inGamePlayers[player.name].H
                        elif stat==3:
                            total+=team.inGamePlayers[player.name].d
                        elif stat==4:
                            total+=team.inGamePlayers[player.name].t
                        elif stat==5:
                            total+=team.inGamePlayers[player.name].HR
                        elif stat==6:
                            total+=team.inGamePlayers[player.name].RBI
                        elif stat==7:
                            total+=team.inGamePlayers[player.name].BB
                        elif stat==8:
                            total+=team.inGamePlayers[player.name].SO
                    row.append(str(total))
                row.insert(0,'Totals')
            else:
                batterCellFont.set_bold(False)
                player=team.lineup[i-1]
                row=[player.name,str(team.inGamePlayers[player.name].AB),str(team.inGamePlayers[player.name].R),str(team.inGamePlayers[player.name].H),str(team.inGamePlayers[player.name].d),str(team.inGamePlayers[player.name].t),str(team.inGamePlayers[player.name].HR),str(team.inGamePlayers[player.name].RBI),str(team.inGamePlayers[player.name].BB),str(team.inGamePlayers[player.name].SO)]
            for col in range(10):
                if col==0:
                    self.displayText(screen,row[col],batterCellFont,BLACK,pos=(left+width*.05,top+i*batterCellHeight+batterCellHeight*.1))
                else:
                    cellx1=width*.3
                    cellWidth=width*.7/9
                    self.displayText(screen,row[col],batterCellFont,BLACK,center=(left+cellx1+(col-1)*cellWidth+cellWidth/2,top+i*batterCellHeight+batterCellHeight*.5))
            pygame.draw.line(screen,BLACK,(left,top+(i+1)*batterCellHeight),(left+width,top+(i+1)*batterCellHeight))
        for i in range(pitcherRows):
            if i==0:
                row0Rect=pygame.Rect(left,top+height*.8,width,batterCellHeight)
                pygame.draw.rect(screen,LIGHT_GRAY,row0Rect)
                row=['Player','IP','H','R','ER','BB','SO','HR']
                batterCellFont.set_bold(True)
            else:
                batterCellFont.set_bold(False)
                player=team.startingPitcher
                IP=team.inGamePlayers[player.name].IP
                if IP>=10:
                    stIP=str(IP)[:4]
                else:
                    stIP=str(IP)[:3]
                row=[player.name,stIP,str(team.inGamePlayers[player.name].HA),str(team.inGamePlayers[player.name].RA),str(team.inGamePlayers[player.name].ER),str(team.inGamePlayers[player.name].BA),str(team.inGamePlayers[player.name].K),str(team.inGamePlayers[player.name].HRA)]
            for col in range(8):
                if col==0:
                    self.displayText(screen,row[col],batterCellFont,BLACK,pos=(left+width*.05,top+height*.8+i*batterCellHeight+batterCellHeight*.1))
                else:
                    cellx1=width*.3
                    cellWidth=width*.7/7
                    self.displayText(screen,row[col],batterCellFont,BLACK,center=(left+cellx1+(col-1)*cellWidth+cellWidth/2,top+height*.8+i*batterCellHeight+batterCellHeight*.5))
            pygame.draw.line(screen,BLACK,(left,top+height*.8+(i+1)*batterCellHeight),(left+width,top+height*.8+(i+1)*batterCellHeight))




    def boxScore(self,screen):
        awayRect=pygame.Rect(self.width*.05,self.height*.1,self.width*.25,self.height*.1)
        homeRect=pygame.Rect(self.width*.05,self.height*.2,self.width*.25,self.height*.1)
        pygame.draw.rect(screen,self.game.awayTeam.team.colors[0],awayRect)
        pygame.draw.rect(screen,self.game.homeTeam.team.colors[0],homeRect)
        self.displayText(screen,self.game.awayTeam.team.cityName,self.pageTitleFont,WHITE,pos=(self.width*.07,self.height*.115))
        self.displayText(screen,self.game.homeTeam.team.cityName,self.pageTitleFont,WHITE,pos=(self.width*.07,self.height*.215))
        self.totalColumns=len(self.game.inningScore)+3
        cellWidth,cellHeight=self.width*.6/self.totalColumns,self.height*.1
        for i,inning in enumerate(self.game.inningScore):
            rect1=pygame.Rect(self.width*.3+i*cellWidth,self.height*.1,cellWidth,cellHeight)
            rect2=pygame.Rect(self.width*.3+i*cellWidth,self.height*.2,cellWidth,cellHeight)
            pygame.draw.rect(screen,WHITE,rect1,4)
            pygame.draw.rect(screen,WHITE,rect2,4)
            self.displayText(screen,str(i+1),self.pageTitleFont,WHITE,center=(self.width*.3+i*cellWidth+cellWidth/2,self.height*.05))
            self.displayText(screen,str(inning[0]),self.pageTitleFont,WHITE,center=(self.width*.3+i*cellWidth+cellWidth/2,self.height*.15))
            self.displayText(screen,str(inning[1]),self.pageTitleFont,WHITE,center=(self.width*.3+i*cellWidth+cellWidth/2,self.height*.25))
        for i,letter in enumerate(['R','H','E']):
            rect1=pygame.Rect(self.width*.3+len(self.game.inningScore)*cellWidth+i*cellWidth,self.height*.1,cellWidth,cellHeight)
            rect2=pygame.Rect(self.width*.3+len(self.game.inningScore)*cellWidth+i*cellWidth,self.height*.2,cellWidth,cellHeight)
            pygame.draw.rect(screen,WHITE,rect1,4)
            pygame.draw.rect(screen,WHITE,rect2,4)
            self.displayText(screen,letter,self.pageTitleFont,WHITE,center=(self.width*.3+(len(self.game.inningScore)+i)*cellWidth+cellWidth/2,self.height*.05))
            if i==0:
                self.displayText(screen,str(self.game.score[0]),self.pageTitleFont,WHITE,center=(self.width*.3+(len(self.game.inningScore)+i)*cellWidth+cellWidth/2,self.height*.15))
                self.displayText(screen,str(self.game.score[1]),self.pageTitleFont,WHITE,center=(self.width*.3+(len(self.game.inningScore)+i)*cellWidth+i*cellWidth+cellWidth/2,self.height*.25))
            elif i==1:
                self.displayText(screen,str(self.game.hits[0]),self.pageTitleFont,WHITE,center=(self.width*.3+(len(self.game.inningScore)+i)*cellWidth+cellWidth/2,self.height*.15))
                self.displayText(screen,str(self.game.hits[1]),self.pageTitleFont,WHITE,center=(self.width*.3+(len(self.game.inningScore)+i)*cellWidth+cellWidth/2,self.height*.25))
            elif i==2:
                self.displayText(screen,str(self.game.errors[0]),self.pageTitleFont,WHITE,center=(self.width*.3+(len(self.game.inningScore)+i)*cellWidth+cellWidth/2,self.height*.15))
                self.displayText(screen,str(self.game.errors[1]),self.pageTitleFont,WHITE,center=(self.width*.3+(len(self.game.inningScore)+i)*cellWidth+cellWidth/2,self.height*.25))





#Other functions
    def displayText(self,screen,text, font, color, pos=(0,0), center=None):
        textSurface=font.render(text,True,color)
        textRect=textSurface.get_rect()
        if center!=None:
            textRect.center=center
            screen.blit(textSurface,textRect)
        else:
            textRect
            screen.blit(textSurface,pos)

    def boundariesForX(self,rect):
        return (rect.topleft,rect.bottomright,rect.topright,rect.bottomleft)

    def mPressed(self):
        self.mode='Menu'
        self.highlightedTeam=0
        self.lineupScreen=False
        self.selectedTeams=[self.ARZ,self.ARZ]
        self.teamIndexes=[0,0]
        self.autoplay=False
        self.sim=False
        self.actionOnly=False
        self.lineupPlayerSelected=None
        self.selectedCell1=None
        self.selectedCell2=None
        self.selectedCell3=None
        self.selectedCell4=None
        self.selectedCell5=None
        self.selectedCell6=None
        self.selectingPitcher=False
        self.selectingBatter=False
        self.fps=30
        self.ballInPlay=False
        self.delayF=0
        self.delay=0
        self.ballBeingPitched=False

    def loadMLBTeams(self):
        self.ARZ=Team('ARZ',self.mlbPlayers)
        self.ATL=Team('ATL',self.mlbPlayers)
        self.BAL=Team('BAL',self.mlbPlayers)
        self.BOS=Team('BOS',self.mlbPlayers)
        self.CHC=Team('CHC',self.mlbPlayers)
        self.CHW=Team('CHW',self.mlbPlayers)
        self.CIN=Team('CIN',self.mlbPlayers)
        self.CLE=Team('CLE',self.mlbPlayers)
        self.COL=Team('COL',self.mlbPlayers)
        self.DET=Team('DET',self.mlbPlayers)
        self.HOU=Team('HOU',self.mlbPlayers)
        self.KC=Team('KC',self.mlbPlayers)
        self.LAA=Team('LAA',self.mlbPlayers)
        self.LAD=Team('LAD',self.mlbPlayers)
        self.MIA=Team('MIA',self.mlbPlayers)
        self.MIL=Team('MIL',self.mlbPlayers)
        self.MIN=Team('MIN',self.mlbPlayers)
        self.NYM=Team('NYM',self.mlbPlayers)
        self.NYY=Team('NYY',self.mlbPlayers)
        self.OAK=Team('OAK',self.mlbPlayers)
        self.PHI=Team('PHI',self.mlbPlayers)
        self.PIT=Team('PIT',self.mlbPlayers)
        self.STL=Team('STL',self.mlbPlayers)
        self.SDP=Team('SDP',self.mlbPlayers)
        self.SFG=Team('SFG',self.mlbPlayers)
        self.SEA=Team('SEA',self.mlbPlayers)
        self.TB=Team('TB',self.mlbPlayers)
        self.TEX=Team('TEX',self.mlbPlayers)
        self.TOR=Team('TOR',self.mlbPlayers)
        self.WSH=Team('WSH',self.mlbPlayers)

    def loadMLBPlayers(self):
        contents=''
        for file in os.listdir('assets\\teamData\\rosters'):
            roster=readFile('assets\\teamData\\rosters\\%s'%file)
            for player in roster.splitlines():
                self.mlbPlayers[player]=Player(player,self.playerInfo)


class Ball(object):
    def __init__(self,image,shadowImage,fence):
        self.x,self.y,self.z=335,472,20
        self.dx,self.dy,self.dz=0,0,0
        self.image=image
        self.shadowImage=shadowImage
        self.groundball=False
        self.fence=fence
    def move(self):
        if not self.fence.fenceContact(self.x+self.dx,self.y-self.dy,self.z+self.dz):
            self.x+=self.dx
            self.y-=self.dy
            if self.z+self.dz>=0:
                self.z+=self.dz
            else:
                self.z=0
                self.groundball=True
            if not self.groundball:
                self.dz-=GRAVITY
            else:
                if self.dx==0: self.dx=.0001
                angle=math.atan(self.dy/self.dx)
                self.ddx,self.ddy=DRAG*math.cos(angle),DRAG*math.sin(angle)
                if self.dx>=0:
                    if self.dx-self.ddx<0:
                        self.dx=0
                    else:
                        self.dx-=self.ddx
                else:
                    if self.dx-self.ddx>0:
                        self.dx=0
                    else:
                        self.dx+=self.ddx
                if self.dy-self.ddy<0:
                    self.dy=0
                else:
                    self.dy+=self.ddy
                self.dz=0
        else:
            self.dx=-self.dx*.3
            self.dy=-self.dy*.4

    def pitch(self):
        self.y+=5

class Fence(object):
    def __init__(self):
        self.fence1x=(-100,304)
        self.fence1y=(286,234)
        self.fence1eq=(-.171,286)
        self.fence2x=(304,389)
        self.fence2y=(234,234)
        self.fence2eq=(0,234)
        self.fence3x=(389,670)
        self.fence3y=(234,288)
        self.fence3eq=(.193,159)
    def fenceContact(self,x,y,z):
        if z>20:
            return False
        if self.fence1x[0]<=x<self.fence1x[1]:
            y1=self.fence1eq[0]*x+self.fence1eq[1]
            if y<=y1:
                return True
            else:
                return False
        elif self.fence2x[0]<=x<self.fence2x[1]:
            y1=self.fence2eq[0]*x+self.fence2eq[1]
            if y<=y1:
                return True
            else:
                return False
        else:
            y1=self.fence3eq[0]*x+self.fence3eq[1]
            if y<=y1:
                return True
            else:
                return False


class AnimatedPlayer(object):
    def __init__(self,image,loc,fence):
        self.image=image
        self.x,self.y=loc
        self.dx,self.dy=0,0
        self.dist=None
        self.speed=2
        self.fence=fence
    def calculateMove(self,destX,destY):
        diffX,diffY=destX-self.x,destY-self.y
        if diffX==0: diffX=.0001
        if diffX>0:
            angle=math.atan(diffY/diffX)
        else:
            angle=math.atan(diffY/diffX)+math.pi
        self.dx,self.dy=self.speed*math.cos(angle),self.speed*math.sin(angle)-.1
    def move(self,ball):
        if not self.fence.fenceContact(self.x+self.dx,self.y+self.dy,0):
            self.x+=self.dx
            self.y+=self.dy
        elif ball.groundball:
            self.calculateMove(ball.x,ball.y)

def findBallDestination(x,y,z,dx,dy,dz):
    t0=(-dz+(dz**2+4*.5*GRAVITY*z)**.5)/(-2*.5*GRAVITY)
    t1=(-dz-(dz**2+4*.5*GRAVITY*z)**.5)/(-2*.5*GRAVITY)
    t=int(max(t0,t1))+1
    destX,destY=x+t*dx,y-t*dy
    return destX,destY

def findBallRest(x,y,dx,dy):
    if dx==0: dx=.00001
    angle=math.atan(dy/dx)
    ddx,ddy=DRAG*math.cos(angle),DRAG*math.sin(angle)
    t=int(dx/ddx)+1
    restX,restY=x+t*dx-t**2*.5*ddx,y-t*dy+t**2*.5*ddy
    return restX,restY

def distance(x0,y0,x1,y1):
    return math.sqrt((x1-x0)**2+(y1-y0)**2)


def main():
    try:
        game=PygameGame(title='MLB Simulator 2017')
        game.run()
    finally:
        pygame.quit()

if __name__ == "__main__":
    main()